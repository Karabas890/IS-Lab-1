<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>Создание нового объекта Product</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    </h:head>

    <h:body class="container mt-5">
        <h:form id="createProductForm" styleClass="needs-validation">

            <!-- Заголовок -->
            <h1 class="mb-4 text-center">Создание нового объекта Product</h1>

            <!-- Шаг 1: Координаты -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5">Шаг 1: Координаты (Coordinates)</h2>
                </div>
                <div class="card-body">

                    <!-- Секция для выбора-->
                    <div id="coordinatesSection">

                        <!-- Список доступных координат -->

                            <label for="coordinatesList" class="form-label">Выберите координаты:</label>
                            <h:selectOneMenu id="coordinatesList" value="#{productBean.selectedCoordinates}"
                                             class="form-select">
                                <f:selectItems value="#{productBean.existingCoordinates}"
                                               var="coord"
                                               itemValue="#{coord}"
                                               itemLabel="#{coord.x}, #{coord.y}" />
                            </h:selectOneMenu>
                        <p:button value="Добавить координаты"
                                  outcome="/createCoordinates.xhtml"
                                  styleClass="btn btn-secondary mt-2" />


                    </div>
                </div>
            </div>

            <!-- Шаг 2: Организация -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5">Шаг 2: Организация (Organization)</h2>
                </div>
                <div class="card-body">

                    <div id="organizationSection">
                        <div class="mt-3">
                            <label for="organizationList" class="form-label">Выберите организацию:</label>
                            <h:selectOneMenu id="organizationList" value="#{productBean.selectedOrganization}"
                                             class="form-select">
                                <f:selectItems value="#{productBean.existingOrganizations}"
                                               var="org"
                                               itemValue="#{org}"
                                               itemLabel="#{org.name}" />
                            </h:selectOneMenu>
                            <p:button value="Добавить организацию"
                                             outcome="createOrganization.xhtml"
                                             styleClass="btn btn-secondary mt-2" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Шаг 3: Поля Product -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5">Шаг 3: Заполнение полей Product</h2>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="productName" class="form-label">Название продукта:</label>
                            <h:inputText id="productName" value="#{productBean.product.name}" required="true"
                                         class="form-control" />
                            <h:message for="productName" class="text-danger" />
                        </div>
                        <div class="col-md-6">
                            <label for="partNumber" class="form-label">Парт. номер:</label>
                            <h:inputText id="partNumber" value="#{productBean.product.partNumber}" required="true"
                                         class="form-control" />
                            <h:message for="partNumber" class="text-danger" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Шаг 4: Информация о Person -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5">Шаг 4: Информация о Person</h2>
                </div>
                <div class="card-body">

                    <!-- Секция для выбора или создания нового Person -->
                    <div id="personSection">
                        <!-- Если выбран существующий Person -->
                        <div class="mt-3">
                            <label for="personList" class="form-label">Выберите существующего Person:</label>
                            <h:selectOneMenu id="personList" value="#{productBean.selectedPerson}"
                                             class="form-select">
                                <f:selectItems value="#{productBean.existingPersons}"
                                               var="person"
                                               itemValue="#{person}"
                                               itemLabel="#{person.name} (#{person.passportID})" />
                            </h:selectOneMenu>
                            <p:button value="Добавить персонал"
                                             outcome="createPerson.xhtml"
                                             styleClass="btn btn-secondary mt-2" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Кнопка создания -->
            <div class="text-center">
                <p:commandButton value="Создать продукт" action="#{productBean.createProduct}"
                                 styleClass="btn btn-success btn-lg" />
            </div>
        </h:form>
    </h:body>
</ui:composition>
